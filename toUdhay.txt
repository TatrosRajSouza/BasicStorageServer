To Udhay:
Overall I had not many problems with your code. 
It worked quite well. However, didn't you notice in your tests, 
that the messages and byte sequences generated from KVQuery were not working?
I mean when I first executed your code it was throwing Exceptions everywhere, due to KVQuery.

A few remarks:
1) CONNECT_ERROR is never sent.

2) DISCONNECT_SUCCESS is never sent. This should be sent by the server after DISCONENCT message is received.

3) No way of updating the values for a key that is already present, e.g. PUT_UPDATE is not handled.

4) We will have to think about deletion as well.

5) When the client closes the connection, A socket Exception is thrown (Connection reset by peer). 
Generates an ugly stacktrace, this could be handled more gracefully. Since the client simply 
closed the connection normally, its not an usual situation and should not throw errors.

